<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		#canvas {
			border: 1px solid;
		}
	</style>
</head>
<body>
	<canvas id="canvas" width="400" height="400">
		你的浏览器不支持canvas
	</canvas>

	<script>
	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");

	function clock() {
		//获取当前的时间
		canvas.height = canvas.height;//设置canvas的宽高，会擦除canvas里边的所有内容

		var now = new Date();
		var h = now.getHours();
		var m = now.getMinutes();
		var s = now.getSeconds();
		h = h > 12 ? (h-12):h;


		ctx.save();
		// ctx.clearRect(0,0,400,400);
		// ctx.canvas.width = ctx.canvas.width;
		ctx.save();
		ctx.translate(200,200);
		var w = 90;
		ctx.fillStyle = "red";
		ctx.font = "24px arial";
		ctx.textAlign = "center";
		for(var i = 12; i > 0; i--) {
			// ctx.moveTo(w*Math.sin(i*Math.PI/6),w*Math.cos(i*Math.PI/6))
			// var m = ctx.measureText(i);
			var x = parseInt(w*Math.sin(-i*Math.PI/6-Math.PI));
			var y = parseInt(w*Math.cos(-i*Math.PI/6-Math.PI)) + 10;

			ctx.fillText(i,x,y);
			// console.log(w*Math.sin(i*Math.PI/6),w*Math.cos(i*Math.PI/6))
		}
		ctx.restore();

		ctx.translate(200,200);
		ctx.rotate(-Math.PI/2);

		//最外层圆圈
		ctx.save();
		ctx.beginPath();
		ctx.strokeStyle = "blue";
		ctx.lineWidth = 8;
		ctx.moveTo(160,0);
		ctx.arc(0,0,160,0,Math.PI*2,false);
		ctx.stroke();
		ctx.restore();

		//时针的刻度
		ctx.save();
		ctx.lineWidth = 8;
		ctx.lineCap = "round";
		for(var i = 0; i<12; i++) {
			ctx.beginPath();
			ctx.rotate(Math.PI/6);
			ctx.moveTo(140,0);
			ctx.lineTo(110,0);
			ctx.stroke();
		}
		ctx.restore();

		//添加数字
		// ctx.save();
		// ctx.rotate(Math.PI/2);
		// for(var i=1;i<=12;i++) {
		// 	ctx.font = "20px Microsoft Yahei";
		// 	ctx.rotate(Math.PI/6);
		// 	var t = ctx.measureText(i);
		// 	ctx.fillText(i,-t.width/2,-90);
		// }
		// ctx.restore();

		//分针、秒针的刻度
		ctx.save();
		ctx.lineWidth = 4;
		ctx.lineCap = "round";
		for(var i = 0; i<60; i++) {
			ctx.beginPath();
			ctx.rotate(Math.PI/30);
			ctx.moveTo(140,0);
			ctx.lineTo(130,0);
			ctx.stroke();
		}
		ctx.restore();

		//绘制时针
		ctx.save();
		ctx.lineWidth = 10;
		ctx.lineCap = "round";
		ctx.beginPath();
		ctx.rotate(h*Math.PI/6 + m*Math.PI/30/12 + s*Math.PI/30/3600);
		ctx.moveTo(0,0);
		ctx.lineTo(80,0);
		ctx.stroke();
		ctx.restore();

		//绘制分针
		ctx.save();
		ctx.lineWidth = 8;
		ctx.lineCap = "round";
		ctx.beginPath();
		ctx.rotate(m*Math.PI/30 + s*Math.PI/30/60);
		ctx.moveTo(0,0);
		ctx.lineTo(120,0);
		ctx.stroke();
		ctx.restore();

		//绘制秒针
		ctx.strokeStyle = "red";
		ctx.lineWidth = 4;
		ctx.lineCap = "round";
		ctx.beginPath();
		ctx.rotate(s*Math.PI/30);
		ctx.moveTo(0,0);
		ctx.lineTo(130,0);
		ctx.stroke();
		ctx.restore();
		window.requestAnimationFrame(clock);//递归
	}
	window.requestAnimationFrame(clock);


	//导出图片
	var url = canvas.toDataURL();
	</script>
</body>
</html>